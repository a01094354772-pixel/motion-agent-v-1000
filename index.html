import React, { useState, useEffect, useMemo, useRef } from 'react';

// --- ë””ìì¸ ë° ì• ë‹ˆë©”ì´ì…˜ ìŠ¤íƒ€ì¼ ---
const styles = `
  @import url('https://fonts.googleapis.com/css2?family=Urbanist:wght@400;700&family=Noto+Sans+KR:wght@300;400;700&display=swap');
  body { font-family: 'Urbanist', 'Noto Sans KR', sans-serif; background-color: #000000; color: #e2e8f0; margin: 0; overflow-x: hidden; }
  .custom-scrollbar::-webkit-scrollbar { width: 4px; }
  .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
  .neon-border { border: 1px solid rgba(222, 255, 154, 0.2); box-shadow: 0 0 20px rgba(222, 255, 154, 0.05); }
  
  .grid-square { transition: all 0.2s ease; cursor: pointer; border-radius: 1px; }
  .grid-square:hover { transform: scale(1.8); z-index: 50; outline: 1px solid white; box-shadow: 0 0 20px rgba(255,255,255,0.6); }
  
  /* í”„ë¡œí•„ë³„ ê³ ìœ  ìƒ‰ìƒ */
  .active-v { background-color: #deff9a !important; box-shadow: 0 0 4px #deff9a; }
  .active-f { background-color: #3b82f6 !important; box-shadow: 0 0 4px #3b82f6; }
  .active-x { background-color: #a855f7 !important; box-shadow: 0 0 4px #a855f7; }
  
  .profile-card { transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.02); }
  .profile-card:hover { border-color: #deff9a; background: rgba(222, 255, 154, 0.05); }
  .profile-active { border-color: #deff9a !important; background: rgba(222, 255, 154, 0.1) !important; transform: translateY(-3px); }
  
  @keyframes pulse-white { 0%, 100% { box-shadow: 0 0 10px white; border: 1px solid white; } 50% { box-shadow: 0 0 30px white; border: 2px solid white; } }
  .matched-highlight { animation: pulse-white 1s infinite; transform: scale(2.0) !important; z-index: 100 !important; background-color: #fff !important; }
  
  @keyframes scan-line { 0% { top: 0; } 100% { top: 100%; } }
  .scanner { position: absolute; left: 0; width: 100%; height: 2px; background: #deff9a; box-shadow: 0 0 15px #deff9a; z-index: 60; animation: scan-line 2s infinite linear; }
`;

const App = () => {
    const [selectedProfile, setSelectedProfile] = useState(null);
    const [builtIndices, setBuiltIndices] = useState(new Set()); 
    const [isBuilding, setIsBuilding] = useState(false);
    const [isSimulating, setIsSimulating] = useState(false);
    const [currentCaseIndex, setCurrentCaseIndex] = useState(-1);
    const [logs, setLogs] = useState(["> ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ. ë¶„ì„í•  ì•Œê³ ë¦¬ì¦˜ í”„ë¡œí•„ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤."]);

    const profiles = [
        { id: 'v', name: 'ë¹„ì „ ì „ìš©', icon: 'fa-eye', color: '#deff9a', target: 'í…ŒìŠ¬ë¼ FSD ë“±', count: 300, range: [0, 299] },
        { id: 'f', name: 'ì„¼ì„œ ìœµí•©', icon: 'fa-microchip', color: '#3b82f6', target: 'ì›¨ì´ëª¨/í˜„ëŒ€ì°¨ ë“±', count: 300, range: [300, 599] },
        { id: 'x', name: 'ì»¤ë„¥í‹°ë“œ V2X', icon: 'fa-tower-broadcast', color: '#a855f7', target: 'ë¡œë³´ì…”í‹€/íƒì‹œ', count: 400, range: [600, 999] }
    ];

    // --- 1,000ê±´ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë°ì´í„° ìƒì„± ë¡œì§ (ì‚¬ê³  ì›ì¸ ë‹¤ê°í™”) ---
    const libraryData = useMemo(() => {
        return Array.from({ length: 1000 }, (_, i) => {
            let type, typeName, scenario, oem, op, env, details;
            
            // ê¸°ì—¬ë„ ê³„ì‚°ê¸° (ì£¼ì›ì¸ ì„¤ì • ë¡œì§ í¬í•¨, ë§ˆì´ë„ˆìŠ¤ ë°©ì§€, í•©ê³„ 100)
            const getLiabilities = (primary) => {
                let vOem = 5 + Math.random() * 15;
                let vOp = 5 + Math.random() * 15;
                let vEnv = 5 + Math.random() * 15;

                if (primary === 'OEM') vOem += 55;
                else if (primary === 'OP') vOp += 55;
                else vEnv += 55;

                const total = vOem + vOp + vEnv;
                return { 
                    oem: Math.round((vOem/total)*100), 
                    op: Math.round((vOp/total)*100), 
                    env: Math.round((vEnv/total)*100) 
                };
            };

            const dice = i % 3; // 0: ì‹œìŠ¤í…œ, 1: ì†ë„/ìš´ì˜, 2: ë…¸ë©´/í™˜ê²½

            if (i < 300) {
                typeName = "ë¹„ì „ ì „ìš©"; type = "v";
                if (dice === 0) {
                    scenario = "ì—­ê´‘ ë…¸ì¶œ ì¸ì§€ ì†Œì‹¤";
                    const l = getLiabilities('OEM'); oem=l.oem; op=l.op; env=l.env;
                    details = "ì‚¬ê³  0.18ì´ˆ ì „ ì¹´ë©”ë¼ ì„¼ì„œì˜ ì—­ê´‘ í¬í™” ë°œìƒ. AI ì•Œê³ ë¦¬ì¦˜ì´ ì „ë°© ì¥ì• ë¬¼ì„ 'ë°°ê²½'ìœ¼ë¡œ ì˜¤íŒí•˜ì—¬ ì œë™ ëª…ë ¹ì„ ìˆ˜í–‰í•˜ì§€ ì•Šì€ ì‹œìŠ¤í…œ ê²°í•¨ì…ë‹ˆë‹¤.";
                } else if (dice === 1) {
                    scenario = "ìš´ì˜ì‚¬ ì„¤ì • ì†ë„ ê³¼ë‹¤";
                    const l = getLiabilities('OP'); oem=l.oem; op=l.op; env=l.env;
                    details = "ì¸ì§€ ì‹œìŠ¤í…œì€ ì •ìƒ ì‘ë™í–ˆìœ¼ë‚˜, ìš´ì˜ì‚¬ê°€ ì„¤ì •í•œ ì£¼í–‰ ì†ë„ê°€ ë„ë¡œì˜ ë¬¼ë¦¬ì  ì œë™ í•œê³„ë¥¼ ì´ˆê³¼í•˜ì—¬ ë°œìƒí•œ ìš´ì˜ ê³¼ì‹¤ì…ë‹ˆë‹¤.";
                } else {
                    scenario = "ë…¸ë©´ ë§ˆì°°ë ¥ ê¸‰ê° ì‚¬ê³ ";
                    const l = getLiabilities('ENV'); oem=l.oem; op=l.op; env=l.env;
                    details = "ì¸ê°€ëœ ì œë™ë ¥ì€ ì •ìƒì´ì—ˆìœ¼ë‚˜, ë¹—ê¸¸ ìˆ˜ë§‰í˜„ìƒìœ¼ë¡œ ì¸í•´ íƒ€ì´ì–´ ë§ˆì°° ê³„ìˆ˜ê°€ 0.3Î¼ ì´í•˜ë¡œ ê¸‰ë½í•˜ì—¬ ë°œìƒí•œ í™˜ê²½ ìš”ì¸ ê¸°ë°˜ ì‚¬ê³ ì…ë‹ˆë‹¤.";
                }
            } else if (i < 600) {
                typeName = "ì„¼ì„œ ìœµí•©"; type = "f";
                if (dice === 0) {
                    scenario = "ì„¼ì„œ ê°„ ë°ì´í„° ì •í•©ì„± ì¶©ëŒ";
                    const l = getLiabilities('OEM'); oem=l.oem; op=l.op; env=l.env;
                    details = "ë¼ì´ë‹¤ì™€ ë ˆì´ë”ì˜ ê°ì²´ ê±°ë¦¬ ë°ì´í„°ì— 0.25m ì”ì°¨ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì•Œê³ ë¦¬ì¦˜ì˜ ë°ì´í„° í•©ì˜ ì§€ì—°ìœ¼ë¡œ ì œë™ì´ 0.2ì´ˆ ëŠ¦ì–´ì§„ ì œì¡°ì‚¬ ê²°í•¨ì…ë‹ˆë‹¤.";
                } else if (dice === 1) {
                    scenario = "íƒ€ì´ì–´ ë§ˆëª¨ ê´€ë¦¬ ì†Œí™€";
                    const l = getLiabilities('OP'); oem=l.oem; op=l.op; env=l.env;
                    details = "ì œì–´ ëª…ë ¹ ëŒ€ë¹„ ì‹¤ì œ ì°¨ëŸ‰ì˜ íš¡ê°€ì†ë„ê°€ ë¬¼ë¦¬ í•œê³„ë¥¼ ë²—ì–´ë‚¬ìŠµë‹ˆë‹¤. ìš´ì˜ì‚¬ì˜ ì •ë¹„ ë¶ˆëŸ‰ìœ¼ë¡œ ì¸í•œ íƒ€ì´ì–´ ì ‘ì§€ë ¥ ìƒì‹¤ì´ ì£¼ì›ì¸ì…ë‹ˆë‹¤.";
                } else {
                    scenario = "í„°ë„ ì§„ì¶œì…ë¡œ ë¸”ë™ì•„ì´ìŠ¤";
                    const l = getLiabilities('ENV'); oem=l.oem; op=l.op; env=l.env;
                    details = "í„°ë„ ì…êµ¬ì˜ ë¯¸ì„¸ ê²°ë¹™ êµ¬ê°„ì—ì„œ ë¯¸ë„ëŸ¬ì§ì´ í¬ì°©ë˜ì—ˆìŠµë‹ˆë‹¤. ì°¨ëŸ‰ì˜ ì¸ì§€ ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ ë¶ˆê°€í•­ë ¥ì  ë„ë¡œ í™˜ê²½ ì‚¬ê³ ë¡œ íŒë…ë©ë‹ˆë‹¤.";
                }
            } else {
                typeName = "ì»¤ë„¥í‹°ë“œ V2X"; type = "x";
                if (dice === 0) {
                    scenario = "ë„¤íŠ¸ì›Œí¬ ì§€ì—° ê´€ì œ ì‹¤íŒ¨";
                    const l = getLiabilities('OEM'); oem=l.oem; op=l.op; env=l.env;
                    details = "í†µì‹  ì§€ì—°(Jitter)ì´ 0.5ì´ˆë¥¼ ì´ˆê³¼í•˜ì—¬ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì›ê²© ê´€ì œ ì‹ í˜¸ê°€ ì°¨ëŸ‰ì— ë„ë‹¬í•˜ê¸° ì „ ì¶©ëŒì´ ë°œìƒí•œ ì¸í”„ë¼ ë° ë„¤íŠ¸ì›Œí¬ ê²°í•¨ì…ë‹ˆë‹¤.";
                } else if (dice === 1) {
                    scenario = "I-ITS ì‹ í˜¸ ë¹„ë™ê¸° ì‚¬ê³ ";
                    const l = getLiabilities('OP'); oem=l.oem; op=l.op; env=l.env;
                    details = "ë””ì§€í„¸ ì‹ í˜¸ ì •ë³´ì™€ ë¬¼ë¦¬ ì‹ í˜¸ì˜ ë¹„ë™ê¸°ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ìš´ì˜ ì•Œê³ ë¦¬ì¦˜ì´ ë‚¡ì€ ì‹ í˜¸ ë°ì´í„°ë¥¼ ì‹ ë¢°í•˜ì—¬ ì§„ì…í•œ ë³µí•© ê³¼ì‹¤ì…ë‹ˆë‹¤.";
                } else {
                    scenario = "ë°°í„°ë¦¬ ì „ì•• ê¸‰ê°•í•˜ ê²°í•¨";
                    const l = getLiabilities('OEM'); oem=l.oem; op=l.op; env=l.env;
                    details = "ì£¼í–‰ ë¶€í•˜ì™€ ë¬´ê´€í•˜ê²Œ ë°°í„°ë¦¬ ì „ì••ì´ ê¸‰ê°•í•˜($B_{score}$ ìœ„í—˜) í•˜ì˜€ìŠµë‹ˆë‹¤. í•˜ë“œì›¨ì–´ ì „ë ¥ ê³µê¸‰ë§ì˜ ì¹˜ëª…ì  ê²°í•¨ì— ì˜í•œ ì œì–´ ìƒì‹¤ ì‚¬ê³ ì…ë‹ˆë‹¤.";
                }
            }
            return { id: i + 1, type, typeName, scenario, liabilities: { oem, op, env }, details };
        });
    }, []);

    const addLog = (msg) => setLogs(prev => [...prev.slice(-10), `> ${msg}`]);

    const startBuilding = async () => {
        if (!selectedProfile || isBuilding) return;
        setIsBuilding(true);
        addLog(`${selectedProfile.name} í”„ë¡œí•„ ë¡œë“œ ë° ${selectedProfile.count}ê±´ ì‚¬ë¡€ êµ¬ì¶• ê°œì‹œ...`);

        const [start, end] = selectedProfile.range;
        let current = start;

        const interval = setInterval(() => {
            const batchSize = 20; 
            setBuiltIndices(prev => {
                const nextSet = new Set(prev);
                for (let i = 0; i < batchSize; i++) {
                    if (current <= end) {
                        nextSet.add(current);
                        current++;
                    }
                }
                return nextSet;
            });

            if (current > end) {
                clearInterval(interval);
                setIsBuilding(false);
                addLog(`${selectedProfile.name} ë¼ì´ë¸ŒëŸ¬ë¦¬ íƒ‘ì¬ ì™„ë£Œ. (0.01ì´ˆ í•´ìƒë„ ë³µì› í¬í•¨)`);
            }
        }, 40);
    };

    // --- ì‚¬ê³  ë°œìƒ ë° ìë™ ë§¤ì¹­ ì‹œë®¬ë ˆì´ì…˜ ---
    const runAccidentSimulation = () => {
        if (builtIndices.size === 0) {
            addLog("ê²½ê³ : ë¨¼ì € ì•Œê³ ë¦¬ì¦˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ êµ¬ì¶•í•´ì•¼ í•©ë‹ˆë‹¤.");
            return;
        }
        setIsSimulating(true);
        setCurrentCaseIndex(-1);
        addLog("ğŸš¨ [ê¸´ê¸‰] ì‹¤ì œ ì‚¬ê³  ì‹œê·¸ë„ ìœ ì… í¬ì°©. ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ ê°œì‹œ...");
        
        setTimeout(() => {
            addLog("> ì¸ì… ë°ì´í„°: 100Hz ê³ í•´ìƒë„ ë¬¼ë¦¬ ë¡œê·¸ ë° ë°°í„°ë¦¬ ì „ì•• ë¶„ì„ ì™„ë£Œ.");
            addLog("> ë§¤ì¹­ ì—”ì§„ ê°€ë™: í˜„ì¬ í™œì„±í™”ëœ 1,000ê±´ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ëŒ€ì¡° ì¤‘...");
            
            // í˜„ì¬ êµ¬ì¶•ëœ ì¸ë±ìŠ¤ ì¤‘ í•˜ë‚˜ë¥¼ ë¬´ì‘ìœ„ë¡œ ë§¤ì¹­ ì‹œì—°
            const builtArray = Array.from(builtIndices);
            const matchIdx = builtArray[Math.floor(Math.random() * builtArray.length)];
            
            setTimeout(() => {
                setCurrentCaseIndex(matchIdx);
                setIsSimulating(false);
                addLog(`ğŸ¯ [ë§¤ì¹­ ì„±ê³µ] ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ë¡€ #${matchIdx + 1}ê³¼ ë¬¼ë¦¬ ê±°ë™ 99.8% ì¼ì¹˜.`);
                addLog(`ğŸ“ íŒë… ê²°ë¡ : ${libraryData[matchIdx].scenario}ì— ì˜í•œ ì‚¬ê³ ë¡œ íŠ¹ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }, 1500);
        }, 1000);
    };

    const reset = () => {
        setSelectedProfile(null);
        setBuiltIndices(new Set());
        setCurrentCaseIndex(-1);
        setLogs(["> ì‹œìŠ¤í…œ ë¦¬ì…‹ ì™„ë£Œ. ìƒˆë¡œìš´ ë¶„ì„ í”„ë¡œí•„ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤."]);
    };

    return (
        <div className="p-8 max-w-[1600px] mx-auto min-h-screen flex flex-col bg-black text-left">
            <style>{styles}</style>
            
            {/* ìƒë‹¨ í—¤ë” */}
            <header className="flex justify-between items-end border-b border-white/10 pb-6 mb-10">
                <div>
                    <div className="flex items-center gap-3 mb-1">
                        <span className="bg-[#deff9a] text-black text-[10px] font-black px-2 py-0.5 rounded uppercase">ê³µí•™ì  ì‚¬ê³  íŒë… ì¸í”„ë¼</span>
                        <h1 className="text-4xl font-black text-white italic tracking-tighter">ì£¼ì‹íšŒì‚¬ ëª¨ì…˜ ì—ì´ì „íŠ¸ ë¸Œì´</h1>
                    </div>
                    <p className="text-slate-500 text-xs font-bold uppercase tracking-widest italic">Algorithm-Specific 1,000 Edge Case Library Map</p>
                </div>
                <div className="flex gap-10">
                    <div className="text-right">
                        <span className="text-[10px] text-slate-500 font-bold block mb-1 uppercase tracking-tighter">ë°ì´í„° í•´ìƒë„</span>
                        <span className="text-emerald-400 text-sm font-black tracking-widest uppercase">100Hz Real-Time</span>
                    </div>
                    <button onClick={reset} className="bg-white/5 hover:bg-white/10 text-white text-xs px-5 py-2 rounded-xl font-bold transition-all border border-white/10 flex items-center gap-2">
                        <i className="fa-solid fa-rotate-left"></i> ì´ˆê¸°í™”
                    </button>
                </div>
            </header>

            <div className="grid grid-cols-1 lg:grid-cols-[450px_1fr] gap-10 flex-grow">
                {/* ì™¼ìª½ ì œì–´íŒ */}
                <aside className="space-y-6">
                    <div className="bg-[#0a0a0a] rounded-3xl p-8 neon-border flex flex-col h-full min-h-[650px]">
                        <h2 className="text-[#deff9a] text-[11px] font-black uppercase tracking-widest mb-8 flex items-center gap-3">
                            <span className="w-2.5 h-2.5 bg-[#deff9a] rounded-full animate-pulse"></span> ë¶„ì„ ì•Œê³ ë¦¬ì¦˜ í”„ë¡œí•„
                        </h2>

                        <div className="space-y-4 flex-grow">
                            {profiles.map(p => (
                                <div 
                                    key={p.id}
                                    onClick={() => !isBuilding && !isSimulating && setSelectedProfile(p)}
                                    className={`profile-card p-6 rounded-2xl cursor-pointer flex items-center gap-6 ${selectedProfile?.id === p.id ? 'profile-active' : ''}`}
                                >
                                    <div className="w-14 h-14 rounded-full bg-black flex items-center justify-center border border-white/10 shadow-inner">
                                        <i className={`fa-solid ${p.icon} text-xl`} style={{color: p.color}}></i>
                                    </div>
                                    <div className="flex-grow text-left">
                                        <div className="flex justify-between items-center mb-1">
                                            <span className="font-bold text-lg text-white">{p.name}</span>
                                            <span className="text-[9px] bg-white/10 px-2 py-0.5 rounded text-slate-400 font-bold uppercase">{p.target}</span>
                                        </div>
                                        <p className="text-[11px] text-slate-400">ë°ì´í„° ë¹„ì¤‘: <strong style={{color: p.color}}>{p.count}ê±´</strong> | <span className={builtIndices.has(p.range[0]) ? "text-emerald-400" : "text-slate-600"}>{builtIndices.has(p.range[0]) ? "êµ¬ì¶•ì™„ë£Œ" : "ëŒ€ê¸°ì¤‘"}</span></p>
                                    </div>
                                </div>
                            ))}

                            <div className="pt-6 space-y-3">
                                <button 
                                    onClick={startBuilding}
                                    disabled={!selectedProfile || isBuilding || isSimulating || builtIndices.has(selectedProfile.range[0])}
                                    className="w-full bg-[#deff9a] text-black py-4 rounded-xl font-black text-sm hover:brightness-110 disabled:opacity-20 transition-all shadow-lg"
                                >
                                    {selectedProfile ? (builtIndices.has(selectedProfile.range[0]) ? "êµ¬ì¶• ì™„ë£Œëœ í”„ë¡œí•„ì…ë‹ˆë‹¤" : `${selectedProfile.name} ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬ì¶•`) : "í”„ë¡œí•„ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤"}
                                </button>

                                <button 
                                    onClick={runAccidentSimulation}
                                    disabled={builtIndices.size === 0 || isBuilding || isSimulating}
                                    className="w-full bg-red-600 text-white py-4 rounded-xl font-black text-sm hover:bg-red-500 disabled:opacity-20 transition-all shadow-xl flex items-center justify-center gap-3"
                                >
                                    {isSimulating ? "ì‚¬ê³  ë°ì´í„° ë¶„ì„ ì¤‘..." : "ì‹¤ì œ ì‚¬ê³  ë°œìƒ ì‹œë®¬ë ˆì´ì…˜"}
                                    <i className="fa-solid fa-car-burst"></i>
                                </button>
                            </div>

                            <div className="mt-8 space-y-6">
                                <div>
                                    <div className="flex justify-between text-[11px] font-black mb-3 uppercase tracking-tighter text-slate-400">
                                        <span>ë¼ì´ë¸ŒëŸ¬ë¦¬ í†µí•© ì™„ì„±ë„</span>
                                        <span>{builtIndices.size} / 1000</span>
                                    </div>
                                    <div className="h-2 bg-white/5 rounded-full overflow-hidden">
                                        <div className="h-full bg-[#deff9a] transition-all duration-150" style={{width: `${(builtIndices.size/1000)*100}%`}}></div>
                                    </div>
                                </div>
                                <div className="bg-black/60 p-5 rounded-2xl border border-white/5 h-40 overflow-y-auto font-mono text-[11px] text-emerald-500/80 leading-relaxed custom-scrollbar">
                                    {logs.map((l, i) => <div key={i} className="mb-1">{l}</div>)}
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>

                {/* ì˜¤ë¥¸ìª½ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§µ ë° ë¦¬í¬íŠ¸ */}
                <main className="flex flex-col gap-8">
                    <div className="bg-[#0a0a0a] rounded-[40px] p-10 neon-border flex flex-col flex-grow relative overflow-hidden">
                        <div className="flex justify-between items-end mb-8">
                            <div>
                                <h2 className="text-3xl font-black text-white italic tracking-tighter uppercase mb-2">ì—£ì§€ ì¼€ì´ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§µ</h2>
                                <p className="text-slate-500 text-xs font-bold uppercase tracking-widest">SHA-256 Hash-Chained 1,000 Edge Scenarios</p>
                            </div>
                            <div className="flex gap-8 text-[11px] font-black uppercase tracking-tighter">
                                <span className="flex items-center gap-2"><div className="w-3.5 h-3.5 rounded-sm bg-[#deff9a]"></div> ë¹„ì „ (300)</span>
                                <span className="flex items-center gap-2"><div className="w-3.5 h-3.5 rounded-sm bg-[#3b82f6]"></div> ìœµí•© (300)</span>
                                <span className="flex items-center gap-2"><div className="w-3.5 h-3.5 rounded-sm bg-[#a855f7]"></div> V2X (400)</span>
                            </div>
                        </div>

                        {/* 1,000ê±´ ê·¸ë¦¬ë“œ ë§µ */}
                        <div className="bg-black/60 rounded-[30px] p-10 border border-white/5 flex-grow overflow-hidden shadow-inner relative">
                            {isSimulating && <div className="scanner"></div>}
                            <div className="grid grid-cols-[repeat(40,minmax(0,1fr))] gap-1.5 h-full overflow-y-auto pr-6 custom-scrollbar">
                                {libraryData.map((item, i) => {
                                    const isBuilt = builtIndices.has(i);
                                    const isMatched = currentCaseIndex === i;
                                    let activeClass = "";
                                    if (isBuilt) {
                                        if (item.type === "v") activeClass = "active-v";
                                        else if (item.type === "f") activeClass = "active-f";
                                        else activeClass = "active-x";
                                    }
                                    
                                    return (
                                        <div 
                                            key={i}
                                            onClick={() => isBuilt && !isSimulating && setCurrentCaseIndex(i)}
                                            className={`grid-square aspect-square ${isBuilt ? activeClass : 'bg-white/5'} ${isMatched ? 'matched-highlight' : ''}`}
                                            title={`ì‚¬ë¡€ #${item.id}: ${item.scenario}`}
                                        />
                                    );
                                })}
                            </div>
                        </div>

                        {/* ìƒì„¸ íŒë… ë¦¬í¬íŠ¸ ì„¹ì…˜ */}
                        {currentCaseIndex !== -1 && (
                            <div className="mt-10 p-10 bg-white/[0.03] rounded-[35px] border border-white/10 animate-in slide-in-from-bottom-6 duration-500">
                                <div className="grid grid-cols-1 xl:grid-cols-[1fr_380px] gap-12 text-left">
                                    <div>
                                        <div className="flex items-center gap-4 mb-8">
                                            <span className="text-[11px] bg-blue-600 text-white px-4 py-1.5 rounded-full font-black uppercase tracking-widest shadow-lg shadow-blue-500/20">ì •ë°€ ì¸ê³¼ê´€ê³„ íŒë… ì„±ê³µ</span>
                                            <h3 className="text-3xl font-black tracking-tighter text-white">
                                                ì‚¬ë¡€ #{String(libraryData[currentCaseIndex].id).padStart(4, '0')} : 
                                                <span className="text-[#deff9a] ml-4">[{libraryData[currentCaseIndex].scenario}]</span>
                                            </h3>
                                        </div>
                                        
                                        <div className="grid grid-cols-3 gap-8 mb-10 text-center">
                                            <div className="bg-black/80 p-6 rounded-3xl border border-white/5">
                                                <span className="text-[10px] text-slate-500 font-bold block mb-3 uppercase tracking-widest text-center">ì œì¡°ì‚¬(HW/SW)</span>
                                                <span className="text-5xl font-black text-red-500">{libraryData[currentCaseIndex].liabilities.oem}%</span>
                                                <div className="h-2 bg-red-500/20 rounded-full mt-5 overflow-hidden"><div className="h-full bg-red-500" style={{width: `${libraryData[currentCaseIndex].liabilities.oem}%`}}></div></div>
                                            </div>
                                            <div className="bg-black/80 p-6 rounded-3xl border border-white/5">
                                                <span className="text-[10px] text-slate-500 font-bold block mb-3 uppercase tracking-widest text-center">ìš´ì˜ì‚¬(ê³¼ì‹¤)</span>
                                                <span className="text-5xl font-black text-amber-500">{libraryData[currentCaseIndex].liabilities.op}%</span>
                                                <div className="h-2 bg-amber-500/20 rounded-full mt-5 overflow-hidden"><div className="h-full bg-amber-500" style={{width: `${libraryData[currentCaseIndex].liabilities.op}%`}}></div></div>
                                            </div>
                                            <div className="bg-black/80 p-6 rounded-3xl border border-white/5">
                                                <span className="text-[10px] text-slate-500 font-bold block mb-3 uppercase tracking-widest text-center">í™˜ê²½/ì¸í”„ë¼</span>
                                                <span className="text-5xl font-black text-blue-500">{libraryData[currentCaseIndex].liabilities.env}%</span>
                                                <div className="h-2 bg-blue-500/20 rounded-full mt-5 overflow-hidden"><div className="h-full bg-blue-500" style={{width: `${libraryData[currentCaseIndex].liabilities.env}%`}}></div></div>
                                            </div>
                                        </div>

                                        <div className="border-t border-white/10 pt-8">
                                            <span className="text-[#deff9a] text-[12px] font-black uppercase tracking-widest mb-4 block text-left">ê³µí•™ì  ì‚¬ê³  ì¸ê³¼ ë¶„ì„ ìš”ì•½</span>
                                            <p className="text-xl leading-relaxed text-slate-200 font-medium italic text-left">
                                                "ë³¸ ì‚¬ë¡€ëŠ” <strong className="text-white">{libraryData[currentCaseIndex].typeName}</strong> ì£¼í–‰ ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ í•˜ì— íŒë…ë˜ì—ˆìŠµë‹ˆë‹¤. ë¶„ì„ ê²°ê³¼ {libraryData[currentCaseIndex].details}"
                                            </p>
                                        </div>
                                    </div>

                                    <div className="bg-black/50 p-10 rounded-[40px] border border-white/5 flex flex-col justify-center text-left">
                                        <h4 className="text-[11px] font-black text-slate-500 uppercase mb-8 tracking-widest border-b border-white/10 pb-4">Metadata & Verification</h4>
                                        <div className="space-y-6 text-sm">
                                            <div className="flex justify-between items-center">
                                                <span className="text-slate-500">ë°ì´í„° ì†ŒìŠ¤</span>
                                                <span className="font-bold text-white uppercase text-xs">Manned Real Seed</span>
                                            </div>
                                            <div className="flex justify-between items-center">
                                                <span className="text-slate-500">ë¬¼ë¦¬ í•´ìƒë„</span>
                                                <span className="font-bold text-[#deff9a] text-xs">100Hz (0.01s)</span>
                                            </div>
                                            <div className="flex justify-between items-center">
                                                <span className="text-slate-500">ë³´ì•ˆ ìˆ˜ì¤€</span>
                                                <span className="font-bold text-blue-400 uppercase text-xs">SHA-256 Secured</span>
                                            </div>
                                            <div className="pt-6">
                                                <p className="text-[10px] text-slate-600 leading-relaxed italic text-center">
                                                    * íŒë…ëœ ëª¨ë“  ê²°ê³¼ëŠ” ìœ„ë³€ì¡°ê°€ ë¶ˆê°€ëŠ¥í•œ í•´ì‹œì²´ì¸ ë¡œê·¸ì— ì˜í•´ ë¬´ê²°ì„±ì´ ë³´ì¦ë©ë‹ˆë‹¤.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                        
                        {!isBuilding && builtIndices.size === 0 && (
                            <div className="absolute inset-0 flex items-center justify-center bg-black/60 backdrop-blur-md z-30">
                                <div className="text-center">
                                    <i className="fa-solid fa-microchip text-5xl text-[#deff9a] mb-6 animate-pulse"></i>
                                    <p className="text-2xl font-black text-white uppercase tracking-tighter">ì•Œê³ ë¦¬ì¦˜ í”„ë¡œí•„ì„ ì„ íƒí•˜ê³  ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬ì¶•ì„ ì‹œì‘í•˜ì‹­ì‹œì˜¤.</p>
                                </div>
                            </div>
                        )}
                    </div>
                </main>
            </div>
        </div>
    );
};

export default App;
