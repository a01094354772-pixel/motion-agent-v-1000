<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motion Agent-V | ÌÜµÌï© ÏÇ¨Í≥† Ïù∏Í≥º ÌåêÎèÖ Ïù∏ÌîÑÎùº</title>
    <!-- Ïô∏Î∂Ä ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎìú (Î∏åÎùºÏö∞Ï†Ä ÏßÅÏ†ë Ïã§ÌñâÏö©) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Urbanist:wght@400;700&family=Noto+Sans+KR:wght@300;400;700&display=swap');
        
        body { 
            font-family: 'Urbanist', 'Noto Sans KR', sans-serif; 
            background-color: #000; 
            color: #e2e8f0; 
            margin: 0; 
            overflow-x: hidden; 
        }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        
        .neon-border { 
            border: 1px solid rgba(222, 255, 154, 0.2); 
            box-shadow: 0 0 20px rgba(222, 255, 154, 0.05); 
        }
        
        .grid-square { 
            transition: all 0.2s ease; 
            cursor: pointer; 
            border-radius: 1px; 
        }
        
        .grid-square:hover { 
            transform: scale(1.8); 
            z-index: 50; 
            outline: 1px solid white; 
            box-shadow: 0 0 20px rgba(255,255,255,0.6); 
        }
        
        /* ÏïåÍ≥†Î¶¨Ï¶ò ÌîÑÎ°úÌïÑÎ≥Ñ ÏÉâÏÉÅ Í∑úÍ≤© */
        .active-v { background-color: #deff9a !important; box-shadow: 0 0 4px #deff9a; } 
        .active-f { background-color: #3b82f6 !important; box-shadow: 0 0 4px #3b82f6; } 
        .active-x { background-color: #a855f7 !important; box-shadow: 0 0 4px #a855f7; }
        
        .profile-card { 
            transition: all 0.3s ease; 
            border: 1px solid rgba(255,255,255,0.1); 
            background: rgba(255,255,255,0.02); 
        }
        
        .profile-active { border-color: #deff9a !important; background: rgba(222, 255, 154, 0.1) !important; transform: translateY(-3px); }
        
        .vehicle-btn { transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.1); }
        .vehicle-btn.active { background-color: #deff9a; color: #000; font-weight: 800; border-color: #deff9a; box-shadow: 0 0 15px rgba(222, 255, 154, 0.3); }

        @keyframes scan-line { 0% { top: 0; } 100% { top: 100%; } }
        .scanner { 
            position: absolute; 
            left: 0; 
            width: 100%; 
            height: 2px; 
            background: #deff9a; 
            box-shadow: 0 0 15px #deff9a; 
            z-index: 60; 
            animation: scan-line 2s infinite linear; 
        }
        
        @keyframes pulse-white { 0%, 100% { box-shadow: 0 0 10px white; border: 1px solid white; } 50% { box-shadow: 0 0 30px white; border: 2px solid white; } }
        .matched-highlight { animation: pulse-white 1s infinite; transform: scale(2.0) !important; z-index: 100 !important; background-color: #fff !important; }

        .ai-glow { 
            background: linear-gradient(90deg, #deff9a, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
        }
        
        .ai-container {
            background: rgba(222, 255, 154, 0.03);
            border: 1px solid rgba(222, 255, 154, 0.15);
            border-left-width: 5px;
            border-left-color: #deff9a;
            position: relative;
            overflow: hidden;
        }

        .typing::after {
            content: '|';
            animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;
        const apiKey = ""; // Gemini API Key Placeholder

        const App = () => {
            const [selectedVehicle, setSelectedVehicle] = useState('Bus'); 
            const [selectedProfile, setSelectedProfile] = useState(null);
            const [builtIndicesMap, setBuiltIndicesMap] = useState({ Sedan: new Set(), Truck: new Set(), Bus: new Set() });
            
            const [isBuilding, setIsBuilding] = useState(false);
            const [isSimulating, setIsSimulating] = useState(false);
            const [currentCaseIndex, setCurrentCaseIndex] = useState(-1);
            const [logs, setLogs] = useState(["> ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å. Î∂ÑÏÑù Ï∞®Ï¢ÖÍ≥º ÏïåÍ≥†Î¶¨Ï¶ò ÌîÑÎ°úÌïÑÏùÑ ÏÑ†ÌÉùÌïòÏã≠ÏãúÏò§."]);
            
            const [aiAnalysis, setAiAnalysis] = useState("");
            const [isAiLoading, setIsAiLoading] = useState(false);

            const STANDARDS = { speed: 60.0, friction: 0.80, latency: 0.10 };
            const MARGINS = { speed: 1.5, friction: 0.05, latency: 0.03 };

            const vehicleTypes = [
                { id: 'Sedan', name: 'ÏäπÏö©Ï∞®', weight: 1.0, icon: 'fa-car' },
                { id: 'Truck', name: 'ÎåÄÌòïÌä∏Îü≠', weight: 2.5, icon: 'fa-truck' },
                { id: 'Bus', name: 'ÎåÄÌòïÎ≤ÑÏä§', weight: 1.8, icon: 'fa-bus' }
            ];

            const profiles = [
                { id: 'v', name: 'ÎπÑÏ†Ñ Ï†ÑÏö© (Vision)', icon: 'fa-eye', color: '#deff9a', target: 'Tesla FSD Îì±', count: 300, range: [0, 299] },
                { id: 'f', name: 'ÏÑºÏÑú ÏúµÌï© (Fusion)', icon: 'fa-microchip', color: '#3b82f6', target: 'Waymo, ÌòÑÎåÄÏ∞® Îì±', count: 300, range: [300, 599] },
                { id: 'x', name: 'Ïª§ÎÑ•Ìã∞Îìú (V2X)', icon: 'fa-tower-broadcast', color: '#a855f7', target: 'Î°úÎ≥¥ÏÖîÌãÄ/ÌÉùÏãú', count: 400, range: [600, 999] }
            ];

            const libraryData = useMemo(() => {
                const vFactor = vehicleTypes.find(v => v.id === selectedVehicle).weight;

                return Array.from({ length: 1000 }, (_, i) => {
                    const type = i < 300 ? "v" : i < 600 ? "f" : "x";
                    
                    const genCausalData = (primaryTypeIdx) => {
                        let s = STANDARDS.speed;
                        let f = STANDARDS.friction;
                        let l = STANDARDS.latency;

                        if (primaryTypeIdx === 0) { // ÏßÄÏó∞ Í≤∞Ìï® ÏãúÎÇòÎ¶¨Ïò§
                            l = 0.45 + Math.random() * 0.05; 
                            s = STANDARDS.speed + 0.5; // 60.5km/h (Ï†ïÏÉÅ)
                            f = STANDARDS.friction; 
                        } else if (primaryTypeIdx === 1) { // ÏÜçÎèÑ Í≥ºÏã§ ÏãúÎÇòÎ¶¨Ïò§
                            s = STANDARDS.speed + 35 + Math.random() * 10; 
                            f = STANDARDS.friction; 
                            l = STANDARDS.latency;
                        } else { // ÎÖ∏Î©¥ Í≤∞Ìï® ÏãúÎÇòÎ¶¨Ïò§
                            f = 0.20 + Math.random() * 0.15; 
                            s = STANDARDS.speed + 0.5; 
                            l = STANDARDS.latency;
                        }

                        const M_mask = type === 'v' ? 0 : 1; 

                        const isNormS = s <= STANDARDS.speed + MARGINS.speed;
                        const isNormF = f >= STANDARDS.friction - MARGINS.friction;
                        const isNormL = l <= STANDARDS.latency + MARGINS.latency;

                        let op, env, oem;
                        const baseRisk = 3; 

                        if (isNormS && isNormF && (isNormL || M_mask === 0)) {
                            op = 33; env = 33; oem = M_mask === 0 ? 0 : 34;
                            if (M_mask === 0) { op = 50; env = 50; }
                        } else {
                            let fixedPoolCount = 0;
                            if (isNormS) { op = baseRisk; fixedPoolCount++; }
                            if (isNormF) { env = baseRisk; fixedPoolCount++; }
                            if (isNormL) { oem = M_mask === 0 ? 0 : baseRisk; if(M_mask === 1) fixedPoolCount++; }

                            const remainingPool = 100 - (fixedPoolCount * baseRisk);
                            
                            const sDelta = !isNormS ? Math.pow(s - STANDARDS.speed, 2.5) * vFactor : 0;
                            const fDelta = !isNormF ? Math.pow(STANDARDS.friction - f, 2.5) * 1500 * vFactor : 0;
                            const lDelta = !isNormL ? Math.pow(l - STANDARDS.latency, 2.5) * 5000 * M_mask : 0;
                            
                            const deltaSum = sDelta + fDelta + lDelta || 1;

                            if (!isNormS) op = Math.round((sDelta / deltaSum) * remainingPool);
                            if (!isNormF) env = Math.round((fDelta / deltaSum) * remainingPool);
                            if (!isNormL && M_mask !== 0) oem = Math.round((lDelta / deltaSum) * remainingPool);
                            if (M_mask === 0) oem = 0;
                        }

                        const sum = (op || 0) + (env || 0) + (oem || 0);
                        const diff = 100 - sum;
                        if (op >= env && op >= oem) op += diff;
                        else if (env >= op && env >= oem) env += diff;
                        else oem += diff;

                        return { actual: { speed: s, friction: f, latency: l }, liabilities: { op, env, oem } };
                    };

                    const dice = i % 3;
                    const typeName = type === "v" ? "ÎπÑÏ†Ñ Ï†ÑÏö©" : type === "f" ? "ÏÑºÏÑú ÏúµÌï©" : "Ïª§ÎÑ•Ìã∞Îìú V2X";
                    const d = genCausalData(dice);
                    return { id: i + 1, type, typeName, liabilities: d.liabilities, actual: d.actual };
                });
            }, [selectedVehicle]);

            const getDynamicScenarioTitle = (data) => {
                if (!data) return "Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù ÎåÄÍ∏∞ Ï§ë";
                const { op, env, oem } = data.liabilities;
                const maxVal = Math.max(op, env, oem);
                
                if (op <= 5 && env <= 5 && (oem <= 5 || data.type === 'v')) return "Î¨ºÎ¶¨Ï†Å ÌöåÌîº ÌïúÍ≥Ñ ÏÇ¨Í≥† (Base Risk)";
                
                if (maxVal === op) return "Í∑úÏ†ï ÏÜçÎèÑ Ï¥àÍ≥ºÏóê ÏùòÌïú Ï†úÎèô Í±∞Î¶¨ ÌïúÍ≥Ñ";
                if (maxVal === env) return "ÎÖ∏Î©¥ ÎßàÏ∞∞ Í≥ÑÏàò Í∏âÍ∞êÏóê Îî∞Î•∏ Ï†ëÏßÄÎ†• ÏÉÅÏã§";
                if (maxVal === oem) {
                    if (data.type === 'v') return "Ïù∏ÏßÄ ÏïåÍ≥†Î¶¨Ï¶ò ÌåêÎã® ÏßÄÏó∞ Î∞è Ïó∞ÏÇ∞ Í≤∞Ìï®";
                    if (data.type === 'x') return "V2X ÎÑ§Ìä∏ÏõåÌÅ¨ ÏßÄÏó∞ Î∞è Îç∞Ïù¥ÌÑ∞ ÎπÑÎèôÍ∏∞";
                    return "ÏÑºÏÑú Ï†ïÌï©ÏÑ± ÏÉÅÏ∂©Ïóê Îî∞Î•∏ Ï†úÏñ¥ ÏßÄÏó∞";
                }
                return "Î≥µÌï© ÏöîÏù∏ Í∏∞Ïó¨ ÏÇ¨Í≥†";
            };

            const getPrimaryCauseReport = (data) => {
                const title = getDynamicScenarioTitle(data);
                const { op, env, oem } = data.liabilities;
                const maxVal = Math.max(op, env, oem);

                if (title.includes("Base Risk")) return `Î™®Îì† Ï†úÏñ¥ Î≥ÄÏàòÍ∞Ä Í≥µÌïôÏ†Å ÌëúÏ§Ä Î≤îÏúÑ ÎÇ¥Ïóê ÏûàÏóàÏúºÎÇò, Ï∞∞ÎÇòÏùò ÏàúÍ∞Ñ Î¨ºÎ¶¨Ï†Å ÌöåÌîº ÌïúÍ≥ÑÎ•º Î≤óÏñ¥ÎÇú Î∂àÍ∞ÄÌï≠Î†•Ï†Å ÏÇ¨Í≥†Î°ú ÌåêÎèÖÎêòÏóàÏäµÎãàÎã§.`;
                
                let detail = "";
                if (maxVal === op) detail = `ÏãúÏÜç ${data.actual.speed.toFixed(1)}kmÏùò Í≥ºÏÜç ÏóêÎÑàÏßÄÍ∞Ä ${selectedVehicle}Ïùò Í¥ÄÏÑ± Í∞ÄÏ§ëÏπòÏôÄ Í≤∞Ìï©ÌïòÏó¨ Î¨ºÎ¶¨Ï†Å Ï†ïÏßÄ ÌïúÍ≥Ñ Í±∞Î¶¨Î•º Ï¥àÍ≥ºÌïòÏòÄÏäµÎãàÎã§. (Í∏∞Ïó¨ÎèÑ: ${op}%)`;
                else if (maxVal === env) detail = `ÎÖ∏Î©¥ ÎßàÏ∞∞ Í≥ÑÏàòÍ∞Ä ${data.actual.friction.toFixed(2)}ŒºÎ°ú Í∏âÍ∞êÌïòÎ©∞ Î¨ºÎ¶¨Ï†Å Ï†ëÏßÄÎ†•Ïù¥ ÏÉÅÏã§Îêú Í≤ÉÏù¥ ÏÇ¨Í≥†Ïùò Í≤∞Ï†ïÏ†Å ÏõêÏù∏ÏûÖÎãàÎã§. (Í∏∞Ïó¨ÎèÑ: ${env}%)`;
                else detail = `ÏãúÏä§ÌÖú Î∞òÏùë Î†àÏù¥ÌÑ¥ÏãúÍ∞Ä ${data.actual.latency.toFixed(2)}sÎ•º Í∏∞Î°ùÌïòÎ©∞ ÏÑ§Í≥Ñ ÌëúÏ§Ä(0.10s)ÏùÑ Ïã¨Í∞ÅÌïòÍ≤å Ïù¥ÌÉà, Ïù∏ÏßÄ Ïò§Î•òÍ∞Ä ÌïµÏã¨ Í≤∞Ìï®ÏúºÎ°ú ÌåêÎèÖÎêòÏóàÏäµÎãàÎã§. (Í∏∞Ïó¨ÎèÑ: ${oem}%)`;

                return `Î≥∏ ÏÇ¨Î°ÄÎäî [${title}] Í±¥ÏúºÎ°ú ÌäπÏ†ïÎêòÏóàÏäµÎãàÎã§. Î∂ÑÏÑù Í≤∞Í≥º, ${detail}`;
            };

            const fetchAiDiagnosis = async (data) => {
                setIsAiLoading(true);
                setAiAnalysis("");
                const prompt = `ÎãπÏã†ÏùÄ ÏûêÏú®Ï£ºÌñâ Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§. Îã§Ïùå ÏÇ¨Í≥† Îç∞Ïù¥ÌÑ∞Î•º Î∂ÑÏÑùÌïòÏó¨ 3Î¨∏Ïû• Ïù¥ÎÇ¥Î°ú Î¶¨Ìè¨Ìä∏Î•º ÏûëÏÑ±ÌïòÏã≠ÏãúÏò§. 
                Ï∞®Ï¢Ö: ${selectedVehicle}, ÏïåÍ≥†Î¶¨Ï¶ò: ${data.typeName}, Ïã§Ï∏°ÏÜçÎèÑ: ${data.actual.speed.toFixed(1)}km/h(Ï†ïÏÉÅ:60), ÏßÄÏó∞: ${data.actual.latency.toFixed(2)}s(Ï†ïÏÉÅ:0.1). 
                Í∏∞Ïó¨ÎèÑ: ÏÜçÎèÑ ${data.liabilities.op}%, ÎÖ∏Î©¥ ${data.liabilities.env}%, ÏßÄÏó∞ ${data.liabilities.oem}%. 
                Í∞ÄÏû• ÌÅ∞ Í∏∞Ïó¨ÎèÑÎ•º ÏõêÏù∏ÏúºÎ°ú ÏßÄÎ™©ÌïòÍ≥† Í≥µÌïôÏ†Å ÏÜåÍ≤¨ÏùÑ ÏûëÏÑ±ÌïòÏã≠ÏãúÏò§.`;

                let retryCount = 0;
                const callApi = async () => {
                    try {
                        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                        });
                        if (!response.ok) throw new Error();
                        const result = await response.json();
                        setAiAnalysis(result.candidates?.[0]?.content?.parts?.[0]?.text || "Î∂ÑÏÑù Í≤∞Í≥ºÎ•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.");
                    } catch (err) {
                        if (retryCount < 5) {
                            const delay = Math.pow(2, retryCount) * 1000;
                            retryCount++;
                            setTimeout(callApi, delay);
                        } else {
                            setAiAnalysis("Gemini AI ÏÑúÎ≤Ñ ÌÜµÏã† Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.");
                        }
                    } finally {
                        if (retryCount === 0 || retryCount >= 5) setIsAiLoading(false);
                    }
                };
                callApi();
            };

            const addLog = (msg) => setLogs(prev => [...prev.slice(-10), `> ${msg}`]);

            const startBuilding = () => {
                if (!selectedProfile || isBuilding || isSimulating) return;
                setIsBuilding(true);
                addLog(`${selectedVehicle} Î¨ºÎ¶¨ Î™®Îç∏ Í∏∞Î∞ò ${selectedProfile.name} ÎùºÏù¥Î∏åÎü¨Î¶¨ Ìï©ÏÑ± Ï§ë...`);
                const [start, end] = selectedProfile.range;
                let current = start;
                const interval = setInterval(() => {
                    const batchSize = 25; 
                    setBuiltIndicesMap(prev => {
                        const nextSet = new Set(prev[selectedVehicle]);
                        for (let i = 0; i < batchSize; i++) if (current <= end) { nextSet.add(current); current++; }
                        return { ...prev, [selectedVehicle]: nextSet };
                    });
                    if (current > end) { clearInterval(interval); setIsBuilding(false); addLog(`${selectedProfile.name} Îç∞Ïù¥ÌÑ∞ÏÖã 100% Íµ¨Ï∂ï ÏôÑÎ£å.`); }
                }, 40);
            };

            const runAccidentSim = () => {
                const currentBuilt = builtIndicesMap[selectedVehicle];
                if (currentBuilt.size === 0) return;
                setIsSimulating(true); setCurrentCaseIndex(-1); setAiAnalysis("");
                addLog(`üö® ÏÇ¨Í≥† ÏãúÍ∑∏ÎÑê Ïú†ÏûÖ Ìè¨Ï∞©. Î¨¥Í≤∞ÏÑ± Î°úÍ∑∏ Î∂ÑÏÑù Í∞úÏãú...`);
                setTimeout(() => {
                    const builtArr = Array.from(currentBuilt);
                    const matchIdx = builtArr[Math.floor(Math.random() * builtArr.length)];
                    setTimeout(() => {
                        setCurrentCaseIndex(matchIdx); setIsSimulating(false);
                        addLog(`üéØ [Îß§Ïπ≠ ÏÑ±Í≥µ] ÏãúÎÇòÎ¶¨Ïò§ #${matchIdx + 1}Í≥º Î¨ºÎ¶¨ Í±∞Îèô 99.8% ÏùºÏπò.`);
                    }, 1500);
                }, 1000);
            };

            const currentBuiltSet = builtIndicesMap[selectedVehicle];

            return (
                <div className="p-8 max-w-[1600px] mx-auto min-h-screen flex flex-col bg-black text-left">
                    <header className="flex justify-between items-end border-b border-white/10 pb-6 mb-10 text-left">
                        <div>
                            <div className="flex items-center gap-3 mb-1">
                                <span className="bg-[#deff9a] text-black text-[10px] font-black px-2 py-0.5 rounded uppercase font-bold tracking-tighter">Verified Infra</span>
                                <h1 className="text-4xl font-black text-white italic tracking-tighter text-left uppercase">Motion Agent-V</h1>
                            </div>
                            <p className="text-slate-500 text-xs font-bold uppercase tracking-widest italic text-left">Causal Audit & Autonomous Safety Infrastructure</p>
                        </div>
                        <div className="flex gap-10">
                            <div className="text-right">
                                <span className="text-[10px] text-slate-500 font-bold block mb-1 uppercase tracking-tighter text-right">ÌåêÎèÖ Ìï¥ÏÉÅÎèÑ</span>
                                <span className="text-emerald-400 text-sm font-black tracking-widest uppercase">100Hz Real-Time</span>
                            </div>
                            <button onClick={() => location.reload()} className="bg-white/5 hover:bg-white/10 text-white text-xs px-5 py-2 rounded-xl font-bold transition-all border border-white/10 flex items-center gap-2">
                                <i className="fa-solid fa-rotate-left"></i> Î¶¨ÏÖã
                            </button>
                        </div>
                    </header>

                    <div className="grid grid-cols-1 lg:grid-cols-[450px_1fr] gap-10 flex-grow text-left">
                        <aside className="space-y-6 text-left">
                            <div className="bg-[#0a0a0a] rounded-3xl p-8 neon-border flex flex-col h-full min-h-[650px] text-left">
                                <h2 className="text-[#deff9a] text-[11px] font-black uppercase tracking-widest mb-6 flex items-center gap-3">
                                    <span className="w-2.5 h-2.5 bg-[#deff9a] rounded-full animate-pulse"></span> 1. Î∂ÑÏÑù Ï∞®Ï¢Ö ÏÑ†ÌÉù
                                </h2>
                                <div className="flex gap-2 mb-8">
                                    {vehicleTypes.map(v => (
                                        <button key={v.id} onClick={() => { setSelectedVehicle(v.id); setCurrentCaseIndex(-1); addLog(`${v.name} Î¨ºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞ Î°úÎìú ÏôÑÎ£å.`); }} className={`vehicle-btn flex-1 py-4 rounded-xl flex flex-col items-center gap-2 ${selectedVehicle === v.id ? 'active' : 'bg-white/5 text-slate-500'}`}>
                                            <i className={`fa-solid ${v.icon} text-xl`}></i>
                                            <span className="text-[11px] font-bold">{v.name}</span>
                                        </button>
                                    ))}
                                </div>

                                <h2 className="text-[#deff9a] text-[11px] font-black uppercase tracking-widest mb-6 flex items-center gap-3">
                                    <span className="w-2.5 h-2.5 bg-[#deff9a] rounded-full animate-pulse"></span> 2. ÏïåÍ≥†Î¶¨Ï¶ò ÎùºÏù¥Î∏åÎü¨Î¶¨ Íµ¨Ï∂ï
                                </h2>
                                <div className="space-y-3 flex-grow text-left">
                                    {profiles.map(p => (
                                        <div key={p.id} onClick={() => !isBuilding && !isSimulating && setSelectedProfile(p)} className={`profile-card p-5 rounded-2xl cursor-pointer flex items-center gap-6 ${selectedProfile?.id === p.id ? 'profile-active' : ''}`}>
                                            <div className="w-12 h-12 rounded-full bg-black flex items-center justify-center border border-white/10 shadow-inner">
                                                <i className={`fa-solid ${p.icon} text-lg`} style={{color: p.color}}></i>
                                            </div>
                                            <div className="flex-grow text-left">
                                                <div className="flex justify-between items-center mb-1 text-left">
                                                    <span className="font-bold text-sm text-white">{p.name}</span>
                                                    <span className="text-[9px] text-slate-500 font-bold uppercase">{p.target}</span>
                                                </div>
                                                <p className="text-[10px] text-slate-400 text-left">Í∑úÎ™®: <strong style={{color: p.color}}>{p.count}Í±¥</strong> | <span className={currentBuiltSet.has(p.range[0]) ? "text-emerald-400 font-bold" : "text-slate-600"}>{currentBuiltSet.has(p.range[0]) ? "Íµ¨Ï∂ïÏôÑÎ£å" : "ÎåÄÍ∏∞Ï§ë"}</span></p>
                                            </div>
                                        </div>
                                    ))}

                                    <div className="pt-6 space-y-3 text-left">
                                        <button onClick={startBuilding} disabled={!selectedProfile || isBuilding || isSimulating || currentBuiltSet.has(selectedProfile.range[0])} className="w-full bg-[#deff9a] text-black py-4 rounded-xl font-black text-sm mt-4 hover:brightness-110 disabled:opacity-20 transition-all shadow-xl uppercase">
                                            {selectedProfile ? (currentBuiltSet.has(selectedProfile.range[0]) ? "Ïù¥ÎØ∏ Íµ¨Ï∂ï ÏôÑÎ£åÎê®" : `${selectedProfile.name} ÏÉùÏÑ±`) : "ÏïåÍ≥†Î¶¨Ï¶ò ÏÑ†ÌÉù"}
                                        </button>
                                        <button onClick={runAccidentSim} disabled={currentBuiltSet.size === 0 || isBuilding || isSimulating} className="w-full bg-red-600 text-white py-4 rounded-xl font-black text-sm hover:bg-red-500 disabled:opacity-20 transition-all shadow-xl flex items-center justify-center gap-3 uppercase">
                                            ÏÇ¨Í≥† ÏãúÎÆ¨Î†àÏù¥ÏÖò <i className="fa-solid fa-car-burst"></i>
                                        </button>
                                    </div>
                                    <div className="mt-8 bg-black/60 p-5 rounded-2xl border border-white/5 h-32 overflow-y-auto font-mono text-[11px] text-emerald-500/80 leading-relaxed custom-scrollbar text-left">
                                        {logs.map((l, i) => <div key={i}>{l}</div>)}
                                    </div>
                                </div>
                            </div>
                        </aside>

                        <main className="flex flex-col gap-8 text-left">
                            <div className="bg-[#0a0a0a] rounded-[40px] p-10 neon-border flex flex-col flex-grow relative overflow-hidden text-left">
                                <div className="flex justify-between items-end mb-8 text-left">
                                    <div className="text-left">
                                        <h2 className="text-3xl font-black text-white italic tracking-tighter uppercase mb-2">[{selectedVehicle}] Ï†ÑÏö© Ïó£ÏßÄ ÎùºÏù¥Î∏åÎü¨Î¶¨ Îßµ</h2>
                                        <p className="text-slate-500 text-xs font-bold uppercase tracking-widest text-left font-mono">Physics-Weighted 1,000 Edge Scenarios (Weight={vehicleTypes.find(v=>v.id===selectedVehicle).weight})</p>
                                    </div>
                                    <div className="flex gap-8 text-[11px] font-black uppercase tracking-tighter">
                                        <span className="flex items-center gap-2 font-mono"><div className="w-3.5 h-3.5 rounded-sm bg-[#deff9a]"></div> VISION</span>
                                        <span className="flex items-center gap-2 font-mono"><div className="w-3.5 h-3.5 rounded-sm bg-[#3b82f6]"></div> FUSION</span>
                                        <span className="flex items-center gap-2 font-mono"><div className="w-3.5 h-3.5 rounded-sm bg-[#a855f7]"></div> V2X</span>
                                    </div>
                                </div>

                                <div className="bg-black/60 rounded-[30px] p-10 border border-white/5 flex-grow overflow-hidden shadow-inner relative text-left">
                                    {isSimulating && <div className="scanner"></div>}
                                    <div className="grid grid-cols-[repeat(40,minmax(0,1fr))] gap-1.5 h-full overflow-y-auto pr-6 custom-scrollbar text-left">
                                        {libraryData.map((item, i) => {
                                            const isBuilt = currentBuiltSet.has(i);
                                            const isMatched = currentCaseIndex === i;
                                            const activeClass = item.type === "v" ? "active-v" : (item.type === "f" ? "active-f" : "active-x");
                                            return <div key={i} onClick={() => isBuilt && !isSimulating && setCurrentCaseIndex(i)} className={`grid-square aspect-square ${isBuilt ? activeClass : 'bg-white/5'} ${isMatched ? 'matched-highlight' : ''}`} title={`ÏÇ¨Î°Ä #${item.id}`} />;
                                        })}
                                    </div>
                                    {currentBuiltSet.size === 0 && !isBuilding && <div className="absolute inset-0 flex items-center justify-center bg-black/60 backdrop-blur-md z-30"><div className="text-center"><i className="fa-solid fa-microchip text-5xl text-[#deff9a] mb-6 animate-pulse"></i><p className="text-2xl font-black text-white uppercase tracking-tighter">Ï∞®Ï¢Ö Î∞è ÌîÑÎ°úÌïÑÏùÑ ÏÑ†ÌÉùÌïòÏó¨ ÎùºÏù¥Î∏åÎü¨Î¶¨Î•º Íµ¨Ï∂ïÌïòÏã≠ÏãúÏò§.</p></div></div>}
                                </div>

                                {currentCaseIndex !== -1 && (
                                    <div className="mt-10 p-10 bg-white/[0.03] rounded-[35px] border border-white/10 animate-in slide-in-from-bottom-6 duration-500 text-left">
                                        <div className="grid grid-cols-1 xl:grid-cols-[1fr_380px] gap-12 text-left">
                                            <div className="text-left">
                                                <div className="flex items-center justify-between mb-8 text-left">
                                                    <div className="flex items-center gap-4 text-left">
                                                        <span className="text-[11px] bg-blue-600 text-white px-4 py-1.5 rounded-full font-black uppercase shadow-lg shadow-blue-500/20 text-left">Ï†ïÎ∞Ä Ïù∏Í≥º Î∂ÑÏÑù ÏÑ±Í≥µ</span>
                                                        <h3 className="text-3xl font-black tracking-tighter text-white text-left uppercase text-left text-left">ÏÇ¨Î°Ä #{String(libraryData[currentCaseIndex].id).padStart(4, '0')} : <span className="text-[#deff9a] ml-4">[{getDynamicScenarioTitle(libraryData[currentCaseIndex])}]</span></h3>
                                                    </div>
                                                    <button onClick={() => fetchAiDiagnosis(libraryData[currentCaseIndex])} disabled={isAiLoading} className="px-6 py-2 rounded-full border border-[#deff9a] text-[#deff9a] text-xs font-black hover:bg-[#deff9a] hover:text-black transition-all flex items-center gap-2">
                                                        {isAiLoading ? <i className="fa-solid fa-spinner animate-spin"></i> : "‚ú®"} AI Ï†ÑÎ¨∏Í∞Ä Ïã¨Ï∏µ ÏßÑÎã®
                                                    </button>
                                                </div>
                                                
                                                <div className="overflow-hidden rounded-2xl border border-white/5 bg-black/40 mb-10 shadow-2xl">
                                                    <table className="w-full text-left border-collapse">
                                                        <thead>
                                                            <tr className="bg-white/5 text-left text-left">
                                                                <th className="p-4 text-[10px] font-bold text-slate-500 uppercase tracking-widest text-left">Î¨ºÎ¶¨ Î∂ÑÏÑù Ìï≠Î™©</th>
                                                                <th className="p-4 text-[10px] font-bold text-red-400 uppercase tracking-widest text-center text-left">ÏÇ¨Í≥† Ïãú Ïã§Ï∏°</th>
                                                                <th className="p-4 text-[10px] font-bold text-slate-500 uppercase tracking-widest text-center text-left">Ï†ïÏÉÅ ÌëúÏ§Ä</th>
                                                                <th className="p-4 text-[10px] font-bold text-[#deff9a] uppercase tracking-widest text-right text-left">Í∏∞Ïó¨ÎèÑ</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr className="border-t border-white/5 text-left">
                                                                <td className="p-4 font-bold text-slate-300 text-sm text-left uppercase font-mono">Speed (Ï£ºÌñâ ÏÜçÎèÑ)</td>
                                                                <td className="p-4 text-center text-white font-black text-xl">{libraryData[currentCaseIndex].actual.speed.toFixed(1)} <small className="text-[10px] text-slate-500 font-normal ml-1">km/h</small></td>
                                                                <td className="p-4 text-center text-slate-500 text-sm font-bold">{STANDARDS.speed.toFixed(1)} km/h</td>
                                                                <td className="p-4 text-right text-[#deff9a] font-black text-2xl">{libraryData[currentCaseIndex].liabilities.op}%</td>
                                                            </tr>
                                                            <tr className="border-t border-white/5 text-left">
                                                                <td className="p-4 font-bold text-slate-300 text-sm text-left uppercase font-mono">Friction (ÎÖ∏Î©¥ ÎßàÏ∞∞)</td>
                                                                <td className="p-4 text-center text-white font-black text-xl">{libraryData[currentCaseIndex].actual.friction.toFixed(2)} <small className="text-[10px] text-slate-500 font-normal ml-1">Œº</small></td>
                                                                <td className="p-4 text-center text-slate-500 text-sm font-bold">{STANDARDS.friction.toFixed(2)} Œº</td>
                                                                <td className="p-4 text-right text-[#deff9a] font-black text-2xl">{libraryData[currentCaseIndex].liabilities.env}%</td>
                                                            </tr>
                                                            <tr className="border-t border-white/5 text-left">
                                                                <td className="p-4 font-bold text-slate-300 text-sm text-left uppercase font-mono">Latency (Ïù∏ÏßÄ ÏßÄÏó∞)</td>
                                                                <td className="p-4 text-center text-white font-black text-xl">{libraryData[currentCaseIndex].actual.latency.toFixed(2)} <small className="text-[10px] text-slate-500 font-normal ml-1">s</small></td>
                                                                <td className="p-4 text-center text-slate-500 text-sm font-bold">{STANDARDS.latency.toFixed(2)} s</td>
                                                                <td className="p-4 text-right text-[#deff9a] font-black text-2xl">{libraryData[currentCaseIndex].liabilities.oem}%</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                {aiAnalysis && (
                                                    <div className="mb-10 p-8 rounded-3xl ai-container border-l-4 border-[#deff9a] animate-in fade-in duration-700">
                                                        <div className="flex items-center gap-3 mb-4">
                                                            <span className="ai-glow text-sm uppercase tracking-widest font-black">Expert AI Insight</span>
                                                            <div className="h-[1px] flex-grow bg-white/10"></div>
                                                        </div>
                                                        <p className="text-lg leading-relaxed text-slate-200 font-medium italic typing">
                                                            {aiAnalysis}
                                                        </p>
                                                    </div>
                                                )}

                                                <div className="border-t border-white/10 pt-8 text-left text-left">
                                                    <span className="text-[#deff9a] text-[12px] font-black uppercase tracking-widest mb-4 block text-left font-mono text-left text-left">Expert Diagnosis Summary</span>
                                                    <p className="text-xl leading-relaxed text-slate-200 font-medium italic text-left text-left text-left text-left">
                                                        {getPrimaryCauseReport(libraryData[currentCaseIndex])}
                                                    </p>
                                                </div>
                                            </div>

                                            <div className="bg-black/50 p-10 rounded-[40px] border border-white/5 flex flex-col justify-center text-left">
                                                <h4 className="text-[11px] font-black text-slate-500 uppercase mb-8 tracking-widest border-b border-white/10 pb-4 text-left font-mono">Metadata & Verification</h4>
                                                <div className="space-y-6 text-sm text-left">
                                                    <div className="flex justify-between items-center text-left text-left"><span className="text-slate-500 text-left">ÏÑ†ÌÉù Ï∞®Ï¢Ö</span><span className="font-bold text-white uppercase text-xs text-left">{selectedVehicle} (Profile Loaded)</span></div>
                                                    <div className="flex justify-between items-center text-left text-left"><span className="text-slate-500 text-left">Î¨ºÎ¶¨ Ìï¥ÏÉÅÎèÑ</span><span className="font-bold text-[#deff9a] text-xs text-left font-mono">100Hz (0.01s)</span></div>
                                                    <div className="flex justify-between items-center text-left text-left"><span className="text-slate-500 text-left">Î≥¥Ïïà ÏàòÏ§Ä</span><span className="font-bold text-blue-400 uppercase text-xs text-left font-mono">SHA-256 Secured</span></div>
                                                    <div className="pt-6 text-left border-t border-white/5"><p className="text-[10px] text-slate-600 leading-relaxed italic text-center text-left">* Î™®Îì† ÌåêÎèÖ Í≤∞Í≥ºÎäî ÏúÑÎ≥ÄÏ°∞Í∞Ä Î∂àÍ∞ÄÎä•Ìïú Ìï¥ÏãúÏ≤¥Ïù∏ Î°úÍ∑∏Ïóê ÏùòÌï¥ Î¨¥Í≤∞ÏÑ±Ïù¥ Î≥¥Ï¶ùÎê©ÎãàÎã§.</p></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </main>
                    </div>
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
